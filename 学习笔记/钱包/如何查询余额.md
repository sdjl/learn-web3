# 如何查询余额

## 技术栈

- **Wagmi**: React Hooks 库，提供 `useBalance` Hook 查询余额
- **Viem**: 以太坊工具库，提供 `formatEther` 函数格式化余额显示

## 实现概览

- 用 **Wagmi** 的 `useBalance` Hook 查询指定地址的余额
- 用 **Wagmi** 的 `useBalance` Hook 返回的 `refetch` 函数手动刷新余额
- 用 **Viem** 的 `formatEther` 函数将 BigInt 类型的 wei 转换为可读的 ETH 字符串

## 核心实现详情

### 1. 基本查询余额 (`components/wallet/WalletConnection.tsx`)

```typescript
import { useAccount, useBalance } from "wagmi";
import { formatEther } from "viem";

export function WalletConnection() {
  // 获取钱包地址
  const { address } = useAccount();

  // 查询余额
  const { data: balanceData, isLoading } = useBalance({
    address,
    query: { enabled: Boolean(address) },
  });

  return (
    <div>
      {address && (
        <p>
          余额: {formatEther(balanceData?.value || 0n)} {balanceData?.symbol}
        </p>
      )}
    </div>
  );
}
```

### 2. 手动刷新余额 (`app/components/WalletActions.tsx`)

```typescript
import { useAccount, useBalance } from "wagmi";

export function WalletActions() {
  const { address } = useAccount();

  // 获取 refetch 函数用于手动刷新余额
  const { refetch: refetchBalance } = useBalance({
    address,
    query: { enabled: Boolean(address) },
  });

  return <button onClick={() => refetchBalance()}>重新获取余额</button>;
}
```
